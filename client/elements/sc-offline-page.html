<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/app-localize-behavior/app-localize-behavior.html">

<link rel="import" href="../styles/static-styles.html">

<dom-module id="sc-offline-page">
  <template>
    <style include="static-styles">

      .buttons-row {
        @apply --sc-all-caps;
        display: flex;
        flex-direction: row;
        margin-top: var(--sc-size-xl);
        color: var(--sc-primary-accent-color);
        text-decoration: none;
        font-weight:bold;
      }

      .button {
        @apply --sc-skolar-font-size-s;
        margin-top: var(--sc-size-md);
        background-color: var(--sc-primary-accent-color);
        color: var(--sc-tertiary-text-color);
        font-weight: bold;
        text-align: center;
      }

    </style>

    <div id="page-wrap">
      <main>
        <section>
          <article>
            <h1>Using SuttaCentral offline</h1>
            <p>SuttaCentral is a <a href="https://developers.google.com/web/progressive-web-apps/" target="_blank">Progressive
              Web App</a>. On supported devices, many features, including navigation and previously visited pages, will
              continue to work even if you have no internet connection.</p>
            <p>In addition, you can download texts in languages of your choosing and keep reading suttas even when
              offline or with limited data. This is especially useful for users on mobiles with limited data, or in
              regions with poor coverage. If your data is limited, we recommend connecting to wifi before downloading
              large amounts of texts.</p>
            <div class="buttons-row">
              <paper-button raised class="button">Make available offline</paper-button>
            </div>
          </article>
        </section>
      </main>
    </div>
  </template>

  <script>
      class SCOfflinePage extends Polymer.mixinBehaviors([Polymer.AppLocalizeBehavior], ReduxMixin(Polymer.Element)) {
          static get is() {
              return 'sc-offline-page';
          }

          static get properties() {
              return {
                  language: {
                      type: String,
                      statePath: 'siteLanguage',
                      observer: '_siteLanguageChanged'
                  },
                  fallbackLanguage: {
                      type: String,
                      value: 'en'
                  }
              }
          }

          ready() {
              super.ready();
              this.loadResources(this.resolveUrl(`/localization/elements/static_offline-page/${this.fallbackLanguage}.json`), this.fallbackLanguage, true);
          }

          _siteLanguageChanged() {
              if (this.language !== this.fallbackLanguage) {
                  if (this.resources && this.resources[this.language]) {
                      return;
                  }
                  this.loadResources(this.resolveUrl(`/localization/elements/static_offline-page/${this.language}.json`), this.language, true);
              }
          }
      }

      customElements.define(SCOfflinePage.is, SCOfflinePage);
  </script>
</dom-module>